<ul class="pagination">
{% if num_pages > 1 %}
    {% if current_page > 1 %}
    <li><a href="
        {{ path(active_page, app.request.query.all|merge({page: current_page-1})) }}
    ">&laquo;</a></li>
    {% endif %}
    {% if current_page < 6 %}
        {% for i in range(1, min((5+current_page), num_pages)) %}
            <li class="page{% if i == current_page %} active{% endif %}">
                <a href="
                {{ path(active_page, app.request.query.all|merge({page: i})) }}
                ">{{i}}</a>
            </li>
        {% endfor %}
        {% if (num_pages+1) > (5+current_page) %}
            <li class="disabled"><a href="#">...</a></li>
        {% endif %}
    {% else %}
        <li class="disabled"><a href="#">...</a></li>
        {% if (num_pages+1) > (5+current_page) %}
            {% for i in range(current_page-4, min((5+current_page), num_pages)) %}
                <li class="page{% if i == current_page %} active{% endif %}">
                    <a href="
                    {{ path(active_page, app.request.query.all|merge({page: i})) }}
                    ">{{i}}</a>
                </li>
            {% endfor %}
            <li class="disabled"><a href="#">...</a></li>
        {% else %}
            {% for i in range(current_page-4, num_pages) %}
                <li class="page{% if i == current_page %} active{% endif %}">
                    <a href="
                    {{ path(active_page, app.request.query.all|merge({page: i})) }}
                    ">{{i}}</a>
                </li>
            {% endfor %}
        {% endif %}
    {% endif %}
    {% if num_pages > current_page %}
    <li><a href="{{ path(active_page, app.request.query.all|merge({page: current_page+1})) }}">&raquo;</a></li>
    {% endif %}
{% endif %}
</ul>

